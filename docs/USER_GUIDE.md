# 使用者手冊

## 系統簡介

法規對應比對系統是一個專為金融業資安部門設計的 AI 輔助工具，協助快速完成法規遵循修訂工作。

---

## 功能概覽

### 核心功能

1. **文件上傳**：支援法規修正對照表與內規文件（.docx 格式）
2. **自動比對**：使用 RAG 技術搜尋相關內規段落
3. **AI 建議**：透過 Gemini AI 生成具體修改建議
4. **報告匯出**：產生 Word 格式的修改建議報告

---

## 使用步驟

### 步驟 1：準備文件

#### 法規修正對照表

- 格式：`.docx`
- 來源：主管機關（如金管會、證券商公會）公告
- 內容：應包含「修正條文」、「現行條文」、「說明」等欄位

#### 公司內規文件

- 格式：`.docx`
- 位置：放置於專案的 `data/internal_rules` 資料夾
- 內容：公司現行的內部規章制度
- 說明：系統會自動讀取此資料夾內的所有 .docx 文件

### 步驟 2：上傳文件

1. **確認內規文件已放置**：將所有內規文件放入 `data/internal_rules` 資料夾
2. **開啟系統首頁**：可看到「內規資料夾狀態」顯示找到的文件數量
3. **上傳法規文件**：
   - 點擊「法規修正對照表」上傳區
   - 選擇法規文件（單一 .docx 檔案）
4. **確認資訊無誤**：檢查內規文件數量和法規文件名稱
5. **開始分析**：點擊「開始分析」按鈕

### 步驟 3：等待分析

系統將自動執行以下流程：

#### 階段 1：文件解析（約 10-30 秒）

- 解析法規對照表，提取修正條文
- 自動載入 `data/internal_rules` 資料夾的所有內規文件
- 建立向量索引

#### 階段 2：RAG 比對（約 20-40 秒）

- 使用向量檢索技術
- 搜尋與法規修正相關的內規段落
- 每條法規修正找出前 5 個最相關的內規片段

#### 階段 3：AI 建議生成（約 30-90 秒）

- 呼叫 Gemini 2.5 Pro AI 模型
- 傳送**完整內規文件**（而非片段）給 AI
- 分析法規與內規差異
- 生成具體修改建議與理由

### 步驟 4：查看結果

分析完成後，系統提供兩種檢視方式：

#### 📁 按文件分組檢視（預設）

- 以內規文件為單位分組顯示
- 每個文件卡片顯示該文件需要的所有修改
- 適合實際修訂內規時使用

#### 📋 按法規條文檢視

- 以法規修正條文為單位顯示
- 每條法規顯示對應的內規修改建議
- 適合追蹤法規遵循狀況

#### 建議卡片內容

每條建議包含：

- **差異類型標籤**：新增 / 修正 / 刪除
- **受影響內規**：文件名稱與章節
- **法規修正摘要**：修正重點簡述

點擊展開可查看：

1. **建議修正文**：AI 生成的具體修改文句
2. **理由與依據**：說明為何需要修改
3. **追溯資訊**：法規與內規的條號對應

#### 操作按鈕

- **📥 下載 Word**：匯出完整報告（**按文件分組**，.docx 格式）
- **🔄 重新分析**：清空結果，返回上傳頁面

### 步驟 5：審核與採納

1. 下載 Word 報告
2. 逐條檢視 AI 建議
3. 人工審核確認
4. 依公司內部流程提出修正案

---

## 報告格式說明

### Word 報告結構

**報告採用「按文件分組」格式**，方便逐份內規進行修訂。

#### 報告架構

1. **標題頁**：法規對應比對建議報告
2. **文件分組章節**：
   - 每個內規文件獨立一節
   - 文件類型標記（主規章 / 附件範本）
   - 該文件的所有修改建議清單

#### 每條建議包含

| 欄位 | 內容 |
|------|------|
| **法規修正摘要** | 對應的法規條號與修正重點 |
| **變更類型** | 新增 / 修正 / 刪除 |
| **受影響章節** | 內規的哪個章節需要修改 |
| **建議修正文** | AI 產出的具體修改文句 |
| **理由與依據** | 修改理由、法規與內規差異說明 |
| **追溯資訊** | 法規條號 ↔ 內規條號對應 |

### 使用建議

- **綠色標籤**（新增）：內規需新增對應條文
- **黃色標籤**（修正）：內規需修改現有條文
- **紅色標籤**（刪除）：內規需刪除或調整條文

---

## 常見問題

### Q1：支援哪些檔案格式？

目前僅支援 `.docx` 格式（Microsoft Word）。不支援 `.doc`（舊版 Word）、`.pdf` 或其他格式。

### Q2：可以上傳多少份內規文件？

內規文件不需手動上傳，只需放在 `data/internal_rules` 資料夾即可。建議不超過 50 份文件，每個檔案大小不超過 10MB。

### Q3：分析需要多久時間？

取決於文件數量與法規修正項目數量：

- 法規修正 10 條 + 內規 10 份：約 40-60 秒
- 法規修正 20 條 + 內規 50 份：約 90-120 秒

（因為現在傳送完整文件給 AI，處理時間會較長但準確度更高）

### Q4：AI 建議是否可直接採用？

**不建議直接採用**。AI 建議僅供參考，必須經過人工審核確認後才能正式採納。

### Q5：如何提升建議準確度？

1. 確保上傳的內規文件完整且為最新版本
2. 法規對照表應包含完整的「說明」欄
3. 批次上傳相關的內規文件（如同一主題）

### Q6：系統會自動修改內規嗎？

**不會**。系統僅產生修改建議報告，不會自動修改任何內規文件。所有修改需人工執行。

### Q7：如何下載之前的報告？

目前系統不保存歷史記錄。建議在查看結果時立即下載報告。

### Q8：可以調整 AI 生成參數嗎？

目前不開放前端調整。如需調整參數（如溫度、Top-K），請聯繫系統管理員修改後端設定。

---

## 最佳實踐

### 文件準備

1. **統一格式**：確保所有內規使用相同的章節編號格式
2. **版本管理**：檔名包含版本號（如 `SO-02-002_v3.7.docx`）
3. **完整性**：放置完整的內規文件於 `data/internal_rules` 資料夾
4. **檔案命名**：建議使用有意義的檔名（如：`SO-02-002_資訊服務供應商委外風險管理_v3.7.docx`）

### 結果審核

1. **使用文件分組檢視**：按實際要修改的內規文件逐一檢視
2. **優先處理**：先檢視「新增」與「刪除」類型的建議
3. **交叉比對**：對照原始法規公告與內規文件
4. **法務確認**：重要條文修改應諮詢法務部門
5. **分階段採納**：可分批處理修改，降低風險

### 報告管理

1. **命名規則**：重新命名下載的報告（如 `20251011_證券商法規修正建議.docx`）
2. **版本控制**：保存歷次分析報告供追溯
3. **會議資料**：報告可作為內部會議討論資料

---

## 系統限制

### 技術限制

- 僅支援中文文件
- 不支援圖片、圖表解析
- 複雜表格可能解析不完整

### 功能限制

- 無多使用者協作功能
- 無版本比對功能
- 無自動排程功能

---

## 安全注意事項

1. **資料保密**：切勿上傳含個資或機敏資料的文件
2. **網路安全**：建議在公司內網環境使用
3. **檔案管理**：使用完畢後定期清理暫存檔案
4. **權限管理**：僅授權資安部門人員使用

---

## 聯絡支援

如有系統使用問題或建議，請聯繫：

- **技術支援**：[待補充]
- **功能建議**：[待補充]

---

## 更新紀錄

- **v1.0.0** (2025-10-11)
  - 初始版本發布
  - 支援法規對照表與內規比對
  - AI 建議生成功能
  - Word 報告匯出